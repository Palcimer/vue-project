{"version":3,"sources":["webpack:///./src/views/board/skins/contents/Form.vue?c677","webpack:///src/views/board/skins/contents/Form.vue","webpack:///./src/views/board/skins/contents/Form.vue?1481","webpack:///./src/views/board/skins/contents/Form.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","_v","_s","pageTitle","loading","on","save","ref","model","value","callback","$$v","valid","expression","rules","require","label","alphaNum","checkId","id","form","wr_1","$set","skins","uploadImage","_e","staticRenderFns","components","name","props","config","Object","access","String","Number","title","data","confirmPw","uploadFiles","Array","bo_upload_cnt","fill","tags","upImages","isWrite","parentItem","computed","table","bo_table","pid","$route","query","act","mounted","init","fetchSkinList","destroyed","length","$axios","put","methods","initForm","wr_reply","wr_parent","mb_id","member","wr_email","mb_email","wr_name","mb_name","wr_password","wr_category","ca","bo_category","wr_title","wr_content","wrTags","wr_2","fileTitle","wrFiles","wrFile","remove","bf_name","component"],"mappings":"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","file":"js/chunk-2d0b363b.f0b376f0.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{attrs:{\"fluid\":\"\"}},[_c('v-toolbar',[_c('v-toolbar-title',[_vm._v(_vm._s(_vm.pageTitle))]),_c('v-spacer'),_c('v-btn',{attrs:{\"color\":\"primary\",\"loading\":_vm.loading},on:{\"click\":_vm.save}},[_c('v-icon',{attrs:{\"left\":\"\"}},[_vm._v(\"mdi-pencil\")]),_vm._v(\" 저장 \")],1)],1),(_vm.form)?_c('v-form',{ref:\"form\",attrs:{\"lazy-validation\":\"\"},model:{value:(_vm.valid),callback:function ($$v) {_vm.valid=$$v},expression:\"valid\"}},[_c('input-duplicate-check',{ref:\"id\",attrs:{\"label\":\"ID\",\"rules\":[_vm.rules.require({ label: 'ID' }), _vm.rules.alphaNum()],\"cbCheck\":_vm.checkId,\"origin\":_vm.id ? _vm.form.wr_1 : '',\"readonly\":!!_vm.id},model:{value:(_vm.form.wr_1),callback:function ($$v) {_vm.$set(_vm.form, \"wr_1\", $$v)},expression:\"form.wr_1\"}}),_c('v-select',{attrs:{\"label\":\"스킨\",\"items\":_vm.skins},model:{value:(_vm.form.wr_2),callback:function ($$v) {_vm.$set(_vm.form, \"wr_2\", $$v)},expression:\"form.wr_2\"}}),_c('v-text-field',{attrs:{\"label\":\"제목\",\"counter\":\"120\",\"rules\":[_vm.rules.require({ label: '제목' })]},model:{value:(_vm.form.wr_title),callback:function ($$v) {_vm.$set(_vm.form, \"wr_title\", $$v)},expression:\"form.wr_title\"}}),_c('ez-tiptap',{attrs:{\"editable\":true},on:{\"uploadImage\":_vm.uploadImage},model:{value:(_vm.form.wr_content),callback:function ($$v) {_vm.$set(_vm.form, \"wr_content\", $$v)},expression:\"form.wr_content\"}})],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <v-container fluid>\r\n    <v-toolbar>\r\n      <v-toolbar-title>{{ pageTitle }}</v-toolbar-title>\r\n      <v-spacer />\r\n      <v-btn @click=\"save\" color=\"primary\" :loading=\"loading\">\r\n        <v-icon left>mdi-pencil</v-icon>\r\n        저장\r\n      </v-btn>\r\n    </v-toolbar>\r\n    <v-form v-if=\"form\" ref=\"form\" v-model=\"valid\" lazy-validation>\r\n\r\n      <input-duplicate-check\r\n        ref=\"id\"\r\n        label=\"ID\"\r\n        v-model=\"form.wr_1\"\r\n        :rules=\"[rules.require({ label: 'ID' }), rules.alphaNum()]\"\r\n        :cbCheck=\"checkId\"\r\n        :origin=\"id ? form.wr_1 : ''\"\r\n        :readonly=\"!!id\"\r\n      />\r\n\r\n      <v-select label=\"스킨\" v-model=\"form.wr_2\" :items=\"skins\" />\r\n\r\n      <v-text-field\r\n        label=\"제목\"\r\n        v-model=\"form.wr_title\"\r\n        counter=\"120\"\r\n        :rules=\"[rules.require({ label: '제목' })]\"\r\n      />\r\n\r\n      <ez-tiptap\r\n        :editable=\"true\"\r\n        v-model=\"form.wr_content\"\r\n        @uploadImage=\"uploadImage\"\r\n      />\r\n    </v-form>\r\n  </v-container>\r\n  <!-- v-data-table -->\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from \"vuex\";\r\nimport InputPassword from \"../../../../components/InputForms/InputPassword.vue\";\r\nimport validateRules from \"../../../../../util/validateRules\";\r\nimport InputDuplicateCheck from \"../../../../../src/components/InputForms/InputDuplicateCheck.vue\";\r\n\r\nexport default {\r\n  components: { InputPassword, InputDuplicateCheck },\r\n  name: \"BasicForm\",\r\n  props: {\r\n    config: Object,\r\n    access: Object,\r\n    id: [String, Number],\r\n  },\r\n  title() {\r\n    return \"ezCode \" + this.pageTitle;\r\n  },\r\n  data() {\r\n    return {\r\n      form: null,\r\n      valid: true,\r\n      confirmPw: \"\",\r\n      uploadFiles: Array(this.config.bo_upload_cnt).fill(null),\r\n      tags: [],\r\n      loading: false,\r\n      upImages: [],\r\n      isWrite: false,\r\n      parentItem: null,\r\n      skins: [],\r\n    };\r\n  },\r\n  computed: {\r\n    ...mapState({\r\n      member: (state) => state.user.member,\r\n    }),\r\n    table() {\r\n      return this.config.bo_table;\r\n    },\r\n    pageTitle() {\r\n      return (\r\n        this.config.bo_subject + (this.id ? \" 게시글 수정\" : \" 게시글 작성\")\r\n      );\r\n    },\r\n    rules: () => validateRules,\r\n    pid() {\r\n      if (this.$route.query.act == \"reply\") {\r\n        return this.id;\r\n      }\r\n      return 0;\r\n    },\r\n  },\r\n  mounted() {\r\n    this.init();\r\n    this.fetchSkinList();\r\n  },\r\n  destroyed() {\r\n    // 작성을 완료하지 않았는데 에디터에서 업로드한 이미지가 있다면 삭제함\r\n    if (this.isWrite == false && this.upImages.length) {\r\n      this.$axios.put(`/api/board/imgCancel/${this.table}`, this.upImages);\r\n    }\r\n  },\r\n  methods: {\r\n    async fetchSkinList() {\r\n      const data = await this.$axios.get(\"/api/contents/skinlist\");\r\n      this.skins = data;\r\n    },\r\n    async checkId() {\r\n      const data = await this.$axios.get(`/api/contents/duplicateCheck?wr_1=${this.form.wr_1}`);\r\n      return data;\r\n    },\r\n    async init() {\r\n      if (this.id) {\r\n        // 기존글에 대한 액션\r\n        const data = await this.$axios.get(\r\n          `/api/board/read/${this.table}/${this.id}`\r\n        );\r\n        if (this.pid) {\r\n          // 부모가 있음(답글)\r\n          this.initForm();\r\n          this.form.wr_category = data.wr_category; // 답글의 카테고리는 부모글의 카테고리를 따라감\r\n          this.parentItem = data;\r\n        } else {\r\n          // 부모가 없음(수정)\r\n          this.form = data;\r\n        }\r\n        this.form.wr_password = \"\";\r\n      } else {\r\n        // 새 글\r\n        this.initForm();\r\n      }\r\n      console.log(\"this.config\", this.config);\r\n      console.log(\"this.form\", this.form);\r\n    },\r\n    initForm() {\r\n      const form = {\r\n        wr_reply: 0,\r\n        wr_parent: this.pid, // 답글 작성일 경우에는 부모 아이디를 가져와야 함\r\n        mb_id: this.member ? this.member.mb_id : 0, // 0=비회원 글 작성\r\n        wr_email: this.member ? this.member.mb_email : \"\",\r\n        wr_name: this.member ? this.member.mb_name : \"\",\r\n        wr_password: \"\",\r\n        wr_category: this.$route.query.ca || this.config.bo_category[0] || \"\", // TODO: 링크할 때 카테고리 정보를 넘긴다 ???\r\n        wr_title: \"\",\r\n        wr_content: \"\",\r\n        wrTags: [],\r\n        // wrImgs: [],\r\n        // wrFiles: [],\r\n      };\r\n      for (let i = 1; i <= 10; i++) {\r\n        form[`wr_${i}`] = \"\";\r\n      }\r\n      form.wr_2 = \"basic\";\r\n      this.form = form;\r\n    },\r\n    async uploadImage({ file, desc, callback }) {\r\n      const formData = new FormData();\r\n      formData.append(\"upFile\", file);\r\n      formData.append(\"bf_desc\", desc);\r\n      const data = await this.$axios.post(\r\n        `/api/board/imageUpload/${this.table}`,\r\n        formData\r\n      );\r\n      this.upImages.push(data);\r\n      callback(`/upload/${this.table}/${data.bf_src}`);\r\n    },\r\n    fileTitle(i) {\r\n      // TODO: 수정 시 업로드한 파일 이름을 사용하기 위함\r\n      if (this.form.wrFiles) {\r\n        const wrFile = this.form.wrFiles[i - 1];\r\n        if (wrFile && !wrFile.remove) {\r\n          return wrFile.bf_name;\r\n        } else {\r\n          return `첨부파일 ${i}`;\r\n        }\r\n      }\r\n    },\r\n    async save() {\r\n      this.$refs.form.validate();\r\n      await this.$nextTick();\r\n      if (!this.valid) return;\r\n      if(!this.$refs.id.validate()) return;\r\n\r\n      this.loading = true;\r\n\r\n      // 폼 데이터 작성\r\n      const formData = new FormData();\r\n      const keys = Object.keys(this.form);\r\n      for (const key of keys) {\r\n        if (typeof this.form[key] == \"object\") {\r\n          formData.append(key, JSON.stringify(this.form[key]));\r\n        } else {\r\n          formData.append(key, this.form[key]);\r\n        }\r\n      }\r\n      // 작성 시 토큰(비회원 게시글 작업용)이 있다면 토큰을 삽입\r\n      if (this.$route.query.token) {\r\n        formData.append(\"token\", this.$route.query.token);\r\n      }\r\n      // 파일 업로드 처리\r\n      let cnt = 0;\r\n      for (let i = 0; i < this.config.bo_upload_cnt; i++) {\r\n        if (this.uploadFiles[i] != null) {\r\n          formData.append(`upfiles[${cnt}]`, this.uploadFiles[i]);\r\n          cnt++;\r\n        }\r\n      }\r\n\r\n      // 에디터에서 업로드한 이미지\r\n      formData.append(\"upImages\", JSON.stringify(this.upImages));\r\n\r\n      let wr_id;\r\n      if (this.id && !this.pid) {\r\n        // 수정\r\n        wr_id = await this.update(formData);\r\n      } else {\r\n        // 새 글\r\n        wr_id = await this.insert(formData);\r\n      }\r\n\r\n      if (wr_id) {\r\n        this.isWrite = true;\r\n        this.$router.push(`/board/${this.table}`);\r\n      }\r\n\r\n      this.loading = false;\r\n    },\r\n    async insert(formData) {\r\n      const data = await this.$axios.post(\r\n        `api/board/write/${this.table}`,\r\n        formData\r\n      );\r\n      return data.wr_id;\r\n    },\r\n    async update(formData) {\r\n      const data = await this.$axios.put(\r\n        `/api/board/write/${this.table}/${this.id}`,\r\n        formData\r\n      );\r\n      return data.wr_id;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n</style>","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Form.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Form.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Form.vue?vue&type=template&id=3e0eacc2&\"\nimport script from \"./Form.vue?vue&type=script&lang=js&\"\nexport * from \"./Form.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}